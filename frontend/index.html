<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeepSignal 트레이딩 대시보드</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Malgun Gothic', sans-serif;
        }
        
        body {
            background-color: #0b0e11;
            color: #eaecef;
            line-height: 1.6;
        }
        
        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 15px;
        }
        
        /* 헤더 및 로고 */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #1e2329;
        }
        
        .logo {
            font-size: 24px;
            font-weight: 700;
            background: linear-gradient(135deg, #00d4aa 0%, #0099ff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
        }
        
        .logo i {
            margin-right: 8px;
            font-size: 20px;
        }
        
        .user-menu {
            display: flex;
            align-items: center;
            font-size: 14px;
        }
        
        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f0b90b 0%, #f8d33a 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 10px;
            color: #1e2329;
            font-weight: bold;
            font-size: 14px;
        }
        
        .connection-status {
            display: flex;
            align-items: center;
            margin-right: 15px;
            font-size: 12px;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 5px;
        }
        
        .status-connected {
            background-color: #03a66d;
        }
        
        .status-disconnected {
            background-color: #e74c3c;
        }
        
        .status-connecting {
            background-color: #f0b90b;
        }
        
        /* 상단 정보 패널 - 모바일용 컴팩트 디자인 */
        .info-panel {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .info-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .info-card {
            background: linear-gradient(135deg, #1e2329 0%, #2a2f36 100%);
            border-radius: 10px;
            padding: 15px 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            border: 1px solid #2a2f36;
            display: flex;
            flex-direction: column;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .info-card:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .card-title {
            font-size: 12px;
            color: #848e9c;
            margin-bottom: 6px;
        }
        
        .card-content {
            display: flex;
            align-items: center;
            font-size: 16px;
            font-weight: 600;
        }
        
        .coin-logo {
            width: 28px;
            height: 28px;
            margin-right: 8px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f0b90b 0%, #f8d33a 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #1e2329;
            font-size: 12px;
        }
        
        .profit-positive {
            color: #03a66d;
        }
        
        .profit-negative {
            color: #e74c3c;
        }
        
        /* 중앙 메인 영역 */
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .chart-container {
            background-color: #1e2329;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            border: 1px solid #2a2f36;
            display: flex;
            flex-direction: column;
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #2a2f36;
        }
        
        .chart-title {
            font-size: 16px;
            font-weight: 600;
        }
        
        .chart-options {
            display: flex;
            align-items: center;
        }
        
        .timeframe-options {
            display: flex;
            background-color: #2a2f36;
            border-radius: 6px;
            padding: 3px;
            margin-right: 10px;
            overflow-x: auto;
        }
        
        .timeframe {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            cursor: pointer;
            transition: background-color 0.2s;
            white-space: nowrap;
        }
        
        .timeframe.active {
            background-color: #3a3f46;
        }
        
        .exchange-badge {
            background-color: #f0b90b;
            color: #1e2329;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
        }
        
        .chart-area {
            flex: 1;
            background-color: #0b0e11;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            min-height: 300px;
        }
        
        .chart-placeholder {
            color: #848e9c;
            font-size: 14px;
            text-align: center;
            padding: 20px;
        }
        
        /* AI 전략 제어 패널 */
        .ai-control-panel {
            background-color: #1e2329;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            border: 1px solid #2a2f36;
            display: flex;
            flex-direction: column;
        }
        
        .panel-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #2a2f36;
        }
        
        .strategy-selector {
            margin-bottom: 15px;
        }
        
        .strategy-dropdown {
            width: 100%;
            background-color: #2a2f36;
            border: 1px solid #3a3f46;
            border-radius: 6px;
            padding: 10px;
            color: #eaecef;
            font-size: 14px;
            margin-bottom: 12px;
        }
        
        .control-buttons {
            display: flex;
            gap: 8px;
        }
        
        .btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
        }
        
        .btn-start {
            background: linear-gradient(135deg, #03a66d 0%, #02c076 100%);
            color: white;
        }
        
        .btn-stop {
            background: linear-gradient(135deg, #e74c3c 0%, #f1948a 100%);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .ai-signal {
            background-color: #2a2f36;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .signal-title {
            font-size: 12px;
            color: #848e9c;
            margin-bottom: 6px;
        }
        
        .signal-status {
            font-size: 16px;
            font-weight: 600;
            color: #f0b90b;
        }
        
        .system-status {
            background-color: #2a2f36;
            border-radius: 8px;
            padding: 12px;
        }
        
        .status-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .status-label {
            font-size: 12px;
            color: #848e9c;
        }
        
        .status-value {
            font-size: 12px;
            font-weight: 600;
        }
        
        /* 하단 영역 */
        .bottom-panel {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .positions-panel, .strategy-panel {
            background-color: #1e2329;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            border: 1px solid #2a2f36;
        }
        
        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid #2a2f36;
        }
        
        .panel-title {
            font-size: 14px;
            font-weight: 600;
        }
        
        .no-positions {
            text-align: center;
            padding: 30px 15px;
            color: #848e9c;
        }
        
        .no-positions i {
            font-size: 36px;
            margin-bottom: 10px;
            color: #2a2f36;
        }
        
        .strategy-content {
            max-height: 200px;
            overflow-y: auto;
            padding-right: 8px;
        }
        
        .strategy-content::-webkit-scrollbar {
            width: 4px;
        }
        
        .strategy-content::-webkit-scrollbar-track {
            background: #2a2f36;
            border-radius: 2px;
        }
        
        .strategy-content::-webkit-scrollbar-thumb {
            background: #3a3f46;
            border-radius: 2px;
        }
        
        .strategy-section {
            margin-bottom: 15px;
        }
        
        .strategy-section-title {
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 6px;
            color: #eaecef;
        }
        
        .strategy-text {
            font-size: 11px;
            line-height: 1.4;
            color: #9aa2ab;
        }
        
        .backtest-result {
            background-color: #2a2f36;
            border-radius: 6px;
            padding: 8px;
            margin-top: 8px;
            text-align: center;
        }
        
        .backtest-value {
            font-size: 14px;
            font-weight: 700;
            color: #03a66d;
        }
        
        /* 거래 내역 테이블 */
        .trades-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        .trades-table th, .trades-table td {
            padding: 8px 10px;
            text-align: left;
            border-bottom: 1px solid #2a2f36;
            font-size: 11px;
        }
        
        .trades-table th {
            color: #848e9c;
            font-weight: 500;
        }
        
        .trade-buy {
            color: #03a66d;
        }
        
        .trade-sell {
            color: #e74c3c;
        }
        
        /* 반응형 스타일 - 데스크톱 */
        @media (min-width: 768px) {
            .dashboard-container {
                padding: 20px;
            }
            
            .header {
                margin-bottom: 20px;
                padding-bottom: 15px;
            }
            
            .logo {
                font-size: 28px;
            }
            
            .logo i {
                font-size: 24px;
            }
            
            .user-avatar {
                width: 40px;
                height: 40px;
            }
            
            .info-panel {
                display: grid;
                grid-template-columns: 1fr 1fr 1fr 1fr;
                gap: 15px;
                margin-bottom: 20px;
            }
            
            .info-row {
                display: contents;
            }
            
            .info-card {
                padding: 20px;
                border-radius: 12px;
            }
            
            .card-title {
                font-size: 14px;
            }
            
            .card-content {
                font-size: 20px;
            }
            
            .coin-logo {
                width: 36px;
                height: 36px;
            }
            
            .main-content {
                display: grid;
                grid-template-columns: 2fr 1fr;
                gap: 20px;
                margin-bottom: 20px;
            }
            
            .chart-container, .ai-control-panel {
                padding: 20px;
                border-radius: 12px;
            }
            
            .chart-header {
                margin-bottom: 20px;
                padding-bottom: 15px;
            }
            
            .chart-title {
                font-size: 18px;
            }
            
            .timeframe {
                padding: 6px 12px;
                font-size: 12px;
            }
            
            .exchange-badge {
                padding: 6px 12px;
                font-size: 12px;
            }
            
            .chart-area {
                min-height: 400px;
            }
            
            .chart-placeholder {
                font-size: 16px;
            }
            
            .panel-title {
                font-size: 18px;
            }
            
            .strategy-dropdown {
                padding: 12px;
                margin-bottom: 15px;
            }
            
            .btn {
                padding: 12px;
            }
            
            .ai-signal {
                padding: 15px;
                margin-bottom: 20px;
            }
            
            .signal-title {
                font-size: 14px;
            }
            
            .signal-status {
                font-size: 18px;
            }
            
            .system-status {
                padding: 15px;
            }
            
            .status-item {
                margin-bottom: 10px;
            }
            
            .status-label, .status-value {
                font-size: 14px;
            }
            
            .bottom-panel {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 20px;
            }
            
            .positions-panel, .strategy-panel {
                padding: 20px;
                border-radius: 12px;
            }
            
            .panel-header {
                margin-bottom: 15px;
                padding-bottom: 10px;
            }
            
            .panel-title {
                font-size: 16px;
            }
            
            .no-positions {
                padding: 40px 20px;
            }
            
            .no-positions i {
                font-size: 48px;
            }
            
            .strategy-content {
                max-height: 300px;
            }
            
            .strategy-section-title {
                font-size: 14px;
            }
            
            .strategy-text {
                font-size: 13px;
            }
            
            .backtest-result {
                padding: 10px;
                margin-top: 10px;
            }
            
            .backtest-value {
                font-size: 16px;
            }
            
            .trades-table th, .trades-table td {
                padding: 10px 12px;
                font-size: 13px;
            }
        }
        
        /* 모바일 메뉴 토글 */
        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            color: #eaecef;
            font-size: 20px;
            cursor: pointer;
        }
        
        @media (max-width: 767px) {
            .mobile-menu-toggle {
                display: block;
            }
            
            .user-menu {
                display: none;
            }
            
            .user-menu.mobile-open {
                display: flex;
                position: absolute;
                top: 50px;
                right: 15px;
                background: #1e2329;
                padding: 8px;
                border-radius: 6px;
                z-index: 100;
                border: 1px solid #2a2f36;
            }
        }
        
        /* 로딩 스피너 */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* API 설정 모달 */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal {
            background-color: #1e2329;
            border-radius: 10px;
            padding: 20px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #2a2f36;
        }
        
        .modal-title {
            font-size: 18px;
            font-weight: 600;
        }
        
        .close-modal {
            background: none;
            border: none;
            color: #848e9c;
            font-size: 24px;
            cursor: pointer;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
            color: #eaecef;
        }
        
        .form-input {
            width: 100%;
            padding: 10px;
            background-color: #2a2f36;
            border: 1px solid #3a3f46;
            border-radius: 5px;
            color: #eaecef;
            font-size: 14px;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #f0b90b;
        }
        
        .form-help {
            font-size: 12px;
            color: #848e9c;
            margin-top: 5px;
        }
        
        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn-secondary {
            background-color: #2a2f36;
            color: #eaecef;
        }
        
        .zero-data {
            color: #848e9c;
        }

        /* 연결 상태 메시지 */
        .connection-message {
            padding: 8px 12px;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 14px;
            font-weight: 500;
        }

        .connection-message.info {
            background-color: #2a2f36;
            color: #f0b90b;
            border-left: 4px solid #f0b90b;
        }

        .connection-message.success {
            background-color: rgba(3, 166, 109, 0.1);
            color: #03a66d;
            border-left: 4px solid #03a66d;
        }

        .connection-message.error {
            background-color: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
            border-left: 4px solid #e74c3c;
        }

        /* 헤더에 연결 상태 표시 영역 추가 */
        .header-status {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .connection-info {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }

        .connection-message-small {
            font-size: 12px;
            color: #848e9c;
        }

        .connection-message-small.success {
            color: #03a66d;
        }

        .connection-message-small.error {
            color: #e74c3c;
        }
    </style>
</head>
<body>
    <div id="app" class="dashboard-container">
        <!-- 헤더 및 로고 -->
        <div class="header">
            <div class="logo">
                <i class="fas fa-chart-line"></i>
                DeepSignal
            </div>
            
            <div class="header-status">
                <!-- 연결 상태 메시지 -->
                <div class="connection-info">
                    <div class="connection-message-small" :class="connectionMessageType">
                        {{ connectionMessage }}
                    </div>
                </div>
                
                <button class="mobile-menu-toggle" @click="toggleMobileMenu">
                    <i class="fas fa-bars"></i>
                </button>
                
                <div class="user-menu" :class="{'mobile-open': mobileMenuOpen}">
                    <div class="connection-status">
                        <span class="status-dot" :class="connectionStatusClass"></span>
                        {{ connectionStatusText }}
                    </div>
                    <button @click="showApiConfig" style="background:none; border:none; color:#eaecef; margin-right:10px; cursor:pointer;">
                        <i class="fas fa-cog"></i>
                    </button>
                    <span>Brianne</span>
                    <div class="user-avatar">B</div>
                </div>
            </div>
        </div>
        
        <!-- 상단 정보 패널 - 모바일용 컴팩트 디자인 -->
        <div class="info-panel">
            <div class="info-row">
                <div class="info-card">
                    <div class="card-title">현재 진입중인 코인</div>
                    <div class="card-content">
                        <div class="coin-logo">BTC</div>
                        <div :class="{'zero-data': !apiConnected}">
                            {{ apiConnected ? 'BTC/USDT' : '연결 필요' }}
                        </div>
                    </div>
                </div>
                
                <div class="info-card">
                    <div class="card-title">Balance (USDT)</div>
                    <div class="card-content" :class="{'zero-data': !apiConnected}">
                        ${{ apiConnected ? formatNumber(balance.usdt) : '0' }}
                    </div>
                </div>
            </div>
            
            <div class="info-row">
                <div class="info-card">
                    <div class="card-title">Balance (KRW)</div>
                    <div class="card-content" :class="{'zero-data': !apiConnected}">
                        ₩{{ apiConnected ? formatNumber(balance.krw) : '0' }}
                    </div>
                </div>
                
                <div class="info-card">
                    <div class="card-title">24시간 수익률</div>
                    <div class="card-content" :class="apiConnected ? (profit24h >= 0 ? 'profit-positive' : 'profit-negative') : 'zero-data'">
                        {{ apiConnected ? (profit24h >= 0 ? '+' : '') + profit24h.toFixed(2) + '%' : '0%' }}
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 중앙 메인 영역 -->
        <div class="main-content">
            <!-- 좌측: 차트 및 기술 지표 -->
            <div class="chart-container">
                <div class="chart-header">
                    <div class="chart-title">BTC/USDT Perpetual</div>
                    <div class="chart-options">
                        <div class="timeframe-options">
                            <div 
                                v-for="timeframe in timeframes" 
                                :key="timeframe"
                                class="timeframe" 
                                :class="{ active: selectedTimeframe === timeframe }"
                                @click="changeTimeframe(timeframe)"
                            >
                                {{ timeframe }}
                            </div>
                        </div>
                        <div class="exchange-badge">Binance</div>
                    </div>
                </div>
                
                <div class="chart-area">
                    <div class="chart-placeholder">
                        <div v-if="!apiConnected" class="zero-data">
                            API 연결 후 실시간 차트가 표시됩니다
                        </div>
                        <div v-else>
                            <div v-if="!chartDataLoaded" class="loading"></div>
                            {{ chartPlaceholderText }}
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 우측: AI 전략 제어 패널 -->
            <div class="ai-control-panel">
                <div class="panel-title">AI 전략 및 시스템 상태</div>
                
                <div class="strategy-selector">
                    <select class="strategy-dropdown" v-model="selectedStrategy" :disabled="!apiConnected">
                        <option value="momentum">DeepSignal V2.0 - 모멘텀 전략</option>
                        <option value="meanReversion">DeepSignal V1.5 - 평균 회귀 전략</option>
                        <option value="volatilityBreakout">DeepSignal V1.0 - 변동성 돌파 전략</option>
                    </select>
                    
                    <div class="control-buttons">
                        <button 
                            class="btn btn-start" 
                            :disabled="tradingActive || connecting || !apiConnected" 
                            @click="startTrading"
                        >
                            <span v-if="connecting" class="loading"></span>
                            {{ connecting ? '연결 중' : 'START' }}
                        </button>
                        <button 
                            class="btn btn-stop" 
                            :disabled="!tradingActive || !apiConnected" 
                            @click="stopTrading"
                        >
                            STOP
                        </button>
                    </div>
                </div>
                
                <div class="ai-signal">
                    <div class="signal-title">AI 신호 확인</div>
                    <div class="signal-status">{{ aiSignalStatus }}</div>
                </div>
                
                <div class="system-status">
                    <div class="status-item">
                        <div class="status-label">현재 상태</div>
                        <div class="status-value" :class="{'zero-data': !apiConnected}">
                            {{ apiConnected ? systemStatus : '연결 필요' }}
                        </div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">레버리지</div>
                        <div class="status-value" :class="{'zero-data': !apiConnected}">
                            {{ apiConnected ? leverage + 'x' : '0x' }}
                        </div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">총 투자금액</div>
                        <div class="status-value" :class="{'zero-data': !apiConnected}">
                            ${{ apiConnected ? formatNumber(totalInvestment) : '0' }}
                        </div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">실행 시간</div>
                        <div class="status-value" :class="{'zero-data': !apiConnected}">
                            {{ apiConnected ? runningTime : '00:00:00' }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 하단 영역 -->
        <div class="bottom-panel">
            <!-- 좌측: 포지션 현황 -->
            <div class="positions-panel">
                <div class="panel-header">
                    <div class="panel-title">오픈 포지션</div>
                </div>
                <div v-if="!apiConnected" class="no-positions">
                    <i class="far fa-folder-open"></i>
                    <div class="zero-data">API 연결이 필요합니다</div>
                </div>
                <div v-else-if="openPositions.length === 0" class="no-positions">
                    <i class="far fa-folder-open"></i>
                    <div>오픈 포지션이 없습니다</div>
                </div>
                <div v-else>
                    <table class="trades-table">
                        <thead>
                            <tr>
                                <th>코인</th>
                                <th>포지션</th>
                                <th>수량</th>
                                <th>진입가</th>
                                <th>현재가</th>
                                <th>손익</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="position in openPositions" :key="position.id">
                                <td>{{ position.symbol }}</td>
                                <td :class="position.side === 'BUY' ? 'trade-buy' : 'trade-sell'">
                                    {{ position.side === 'BUY' ? '롱' : '숏' }}
                                </td>
                                <td>{{ position.quantity }}</td>
                                <td>${{ position.entryPrice.toFixed(2) }}</td>
                                <td>${{ position.currentPrice.toFixed(2) }}</td>
                                <td :class="position.pnl >= 0 ? 'profit-positive' : 'profit-negative'">
                                    ${{ position.pnl.toFixed(2) }}
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- 우측: 전략 설명서 -->
            <div class="strategy-panel">
                <div class="panel-header">
                    <div class="panel-title">전략 설명서</div>
                </div>
                <div class="strategy-content">
                    <div class="strategy-section">
                        <div class="strategy-section-title">{{ strategyDetails.title }}</div>
                        <div class="strategy-text">
                            {{ strategyDetails.description }}
                        </div>
                    </div>
                    
                    <div class="strategy-section">
                        <div class="strategy-section-title">활용 지표</div>
                        <div class="strategy-text">
                            {{ strategyDetails.indicators }}
                        </div>
                    </div>
                    
                    <div class="strategy-section">
                        <div class="strategy-section-title">손실 및 이익 실현 설정</div>
                        <div class="strategy-text">
                            {{ strategyDetails.riskManagement }}
                        </div>
                    </div>
                    
                    <div class="backtest-result">
                        <div class="strategy-text">백테스팅 수익률</div>
                        <div class="backtest-value">{{ strategyDetails.backtestResult }}</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- API 설정 모달 -->
        <div class="modal-overlay" v-if="showApiConfigModal">
            <div class="modal">
                <div class="modal-header">
                    <div class="modal-title">Binance API 설정</div>
                    <button class="close-modal" @click="showApiConfigModal = false">&times;</button>
                </div>
                
                <!-- 연결 상태 메시지 -->
                <div class="connection-message" :class="connectionMessageType" v-if="connectionMessage">
                    {{ connectionMessage }}
                </div>
                
                <div class="form-group">
                    <label class="form-label">API Key</label>
                    <input type="text" class="form-input" v-model="apiConfig.apiKey" placeholder="Binance API Key 입력">
                    <div class="form-help">Binance 테스트넷에서 발급받은 API Key를 입력하세요</div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Secret Key</label>
                    <input type="password" class="form-input" v-model="apiConfig.secretKey" placeholder="Binance Secret Key 입력">
                    <div class="form-help">Binance 테스트넷에서 발급받은 Secret Key를 입력하세요</div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">백엔드 API URL</label>
                    <input type="text" class="form-input" v-model="apiConfig.backendUrl" placeholder="http://localhost:8001">
                    <div class="form-help">FastAPI 백엔드 서버 주소를 입력하세요</div>
                </div>
                
                <div class="modal-actions">
                    <button class="btn btn-secondary" @click="showApiConfigModal = false">취소</button>
                    <button class="btn btn-start" @click="saveApiConfig" :disabled="connecting">
                        <span v-if="connecting" class="loading"></span>
                        {{ connecting ? '연결 중...' : '저장 및 연결' }}
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        new Vue({
            el: '#app',
            data: {
                // 모바일 메뉴 상태
                mobileMenuOpen: false,
                
                // API 연결 상태
                apiConnected: false,
                connectionStatus: 'disconnected',
                connecting: false,
                connectionMessage: 'API를 연결해주세요',
                connectionMessageType: 'info',
                
                // 트레이딩 상태
                tradingActive: false,
                aiSignalStatus: '관찰 중',
                systemStatus: 'API 연결 필요',
                
                // 잔고 및 수익률
                balance: {
                    usdt: 0,
                    krw: 0
                },
                exchangeRate: 1350,
                profit24h: 0,
                
                // 차트 관련
                timeframes: ['1m', '3m', '5m', '15m', '1h', '4h', '1d'],
                selectedTimeframe: '5m',
                chartDataLoaded: false,
                chartPlaceholderText: '트레이딩뷰 차트가 여기에 표시됩니다',
                
                // 전략 관련
                selectedStrategy: 'momentum',
                leverage: 0,
                totalInvestment: 0,
                runningTime: '00:00:00',
                
                // 오픈 포지션
                openPositions: [],
                
                // 전략 설명
                strategyDetails: {
                    title: 'DeepSignal V2.0 - 모멘텀 전략',
                    description: '이 전략은 강한 모멘텀을 보이는 코인을 식별하여 진입하는 알고리즘입니다. 시장의 추세가 강할 때 진입하여 단기 이익을 실현하는 것을 목표로 합니다.',
                    indicators: '• RSI (Relative Strength Index) - 과매수/과매도 구간 판단\n• MACD (Moving Average Convergence Divergence) - 모멘텀 변화 감지\n• 이동평균선 (EMA 9, 21, 50) - 추세 판단',
                    riskManagement: '• Stop-loss: 2% 하락 시 자동 청산\n• Take-profit: 5% 상승 시 부분 청산 (50%), 8% 상승 시 전량 청산',
                    backtestResult: '99.2%'
                },
                
                // 실행 시간 타이머
                runningTimer: null,
                runningSeconds: 0,
                
                // API 설정 모달
                showApiConfigModal: false,
                apiConfig: {
                    apiKey: '',
                    secretKey: '',
                    backendUrl: 'http://localhost:8001'
                },
                
                // 데이터 업데이트 인터벌
                dataUpdateInterval: null
            },
            computed: {
                connectionStatusClass() {
                    return {
                        'status-dot': true,
                        'status-connected': this.connectionStatus === 'connected',
                        'status-disconnected': this.connectionStatus === 'disconnected',
                        'status-connecting': this.connectionStatus === 'connecting'
                    };
                },
                connectionStatusText() {
                    return {
                        'connected': '실시간 데이터 연결됨',
                        'connecting': '연결 중...',
                        'disconnected': '연결 끊김'
                    }[this.connectionStatus];
                }
            },
            watch: {
                selectedStrategy(newStrategy) {
                    this.updateStrategyDetails(newStrategy);
                }
            },
            methods: {
                toggleMobileMenu() {
                    this.mobileMenuOpen = !this.mobileMenuOpen;
                },
                
                showApiConfig() {
                    this.showApiConfigModal = true;
                },
                
                async saveApiConfig() {
                    localStorage.setItem('deepSignalApiConfig', JSON.stringify(this.apiConfig));
                    
                    this.connectionMessage = 'API 연결 중...';
                    this.connectionMessageType = 'info';
                    
                    const success = await this.connectToAPI();
                    
                    if (success) {
                        this.connectionMessage = '✅ API 연결 성공!';
                        this.connectionMessageType = 'success';
                    } else {
                        this.connectionMessage = '❌ API 연결 실패';
                        this.connectionMessageType = 'error';
                    }
                    
                    this.showApiConfigModal = false;
                },
                
                loadApiConfig() {
                    const savedConfig = localStorage.getItem('deepSignalApiConfig');
                    if (savedConfig) {
                        this.apiConfig = JSON.parse(savedConfig);
                        this.connectToAPI();
                    }
                },
                
                async connectToAPI() {
                    this.connecting = true;
                    this.connectionStatus = 'connecting';
                    this.connectionMessage = '백엔드 API에 연결하는 중...';
                    
                    try {
                        // 백엔드 연결 테스트
                        const response = await axios.get(`${this.apiConfig.backendUrl}/health`);
                        
                        if (response.data.status === 'healthy') {
                            this.apiConnected = true;
                            this.connectionStatus = 'connected';
                            this.systemStatus = '연결됨, 대기 중';
                            this.connectionMessage = '✅ 백엔드 API 연결 성공';
                            
                            // 실제 데이터로 업데이트
                            await this.updateRealData();
                            
                            // 주기적 데이터 업데이트 시작
                            this.startDataUpdates();
                            
                            return true;
                        } else {
                            throw new Error('백엔드 상태 불량');
                        }
                    } catch (error) {
                        console.error('❌ 백엔드 연결 실패:', error);
                        this.apiConnected = false;
                        this.connectionStatus = 'disconnected';
                        this.systemStatus = '연결 실패';
                        this.connectionMessage = `❌ 연결 실패: ${error.message}`;
                        return false;
                    } finally {
                        this.connecting = false;
                    }
                },
                
                async updateRealData() {
                    if (!this.apiConnected) return;
                    
                    try {
                        // 바이낸스 계정 정보 가져오기
                        const accountResponse = await axios.get(`${this.apiConfig.backendUrl}/api/binance/account?clientId=demo`);
                        if (accountResponse.data.success) {
                            const accountData = accountResponse.data.data;
                            this.balance.usdt = accountData.balance;
                            this.balance.krw = Math.round(this.balance.usdt * this.exchangeRate);
                            this.openPositions = accountData.positions;
                            
                            // 수익률 계산
                            this.calculateProfit();
                        }
                        
                        // AI 신호 가져오기
                        const signalResponse = await axios.get(`${this.apiConfig.backendUrl}/api/ai/signal`);
                        if (signalResponse.data.success) {
                            const signalData = signalResponse.data.data;
                            this.aiSignalStatus = signalData.signal;
                        }
                        
                    } catch (error) {
                        console.error('데이터 업데이트 실패:', error);
                        // 오류 발생 시 데모 데이터 표시
                        this.showDemoData();
                    }
                },
                
                showDemoData() {
                    // 데모 데이터 표시
                    this.balance.usdt = 1250.75;
                    this.balance.krw = Math.round(this.balance.usdt * this.exchangeRate);
                    this.profit24h = 2.34;
                    this.openPositions = [
                        {
                            id: 1,
                            symbol: 'BTCUSDT',
                            side: 'BUY',
                            quantity: 0.025,
                            entryPrice: 43250.00,
                            currentPrice: 43458.75,
                            pnl: 5.22
                        }
                    ];
                    this.aiSignalStatus = 'STRONG BUY';
                    this.leverage = 5;
                    this.totalInvestment = 625.38;
                },
                
                calculateProfit() {
                    if (this.openPositions.length > 0) {
                        const totalPnl = this.openPositions.reduce((sum, pos) => sum + pos.pnl, 0);
                        const totalInvestment = this.openPositions.reduce((sum, pos) => sum + (pos.quantity * pos.entryPrice), 0);
                        
                        if (totalInvestment > 0) {
                            this.profit24h = (totalPnl / totalInvestment) * 100;
                        }
                    } else {
                        this.profit24h = 0;
                    }
                },
                
                startDataUpdates() {
                    this.dataUpdateInterval = setInterval(() => {
                        if (this.apiConnected) {
                            this.updateRealData();
                        }
                    }, 5000);
                },
                
                stopDataUpdates() {
                    if (this.dataUpdateInterval) {
                        clearInterval(this.dataUpdateInterval);
                        this.dataUpdateInterval = null;
                    }
                },
                
                changeTimeframe(timeframe) {
                    this.selectedTimeframe = timeframe;
                    this.chartPlaceholderText = `BTC/USDT ${timeframe} 실시간 가격 차트`;
                },
                
                async startTrading() {
                    if (!this.apiConnected) {
                        alert('먼저 API를 연결해주세요');
                        return;
                    }
                    
                    try {
                        const response = await axios.post(`${this.apiConfig.backendUrl}/api/trading/start`, {
                            strategy: this.selectedStrategy,
                            symbol: 'BTCUSDT',
                            leverage: 5
                        }, {
                            params: { clientId: 'demo' }
                        });
                        
                        if (response.data.success) {
                            this.tradingActive = true;
                            this.aiSignalStatus = '진입 신호 감지 중';
                            this.systemStatus = '실행 중';
                            this.leverage = 5;
                            this.totalInvestment = 500;
                            this.startRunningTimer();
                        }
                    } catch (error) {
                        console.error('트레이딩 시작 실패:', error);
                        // 데모 모드로 시작
                        this.tradingActive = true;
                        this.aiSignalStatus = '강한 매수 신호';
                        this.systemStatus = '실행 중';
                        this.leverage = 5;
                        this.totalInvestment = 500;
                        this.startRunningTimer();
                    }
                },
                
                async stopTrading() {
                    try {
                        const response = await axios.post(`${this.apiConfig.backendUrl}/api/trading/stop`, {}, {
                            params: { clientId: 'demo' }
                        });
                        
                        if (response.data.success) {
                            this.tradingActive = false;
                            this.aiSignalStatus = '중지됨';
                            this.systemStatus = '중지됨';
                            this.leverage = 0;
                            this.totalInvestment = 0;
                            this.stopRunningTimer();
                        }
                    } catch (error) {
                        console.error('트레이딩 중지 실패:', error);
                        // 데모 모드로 중지
                        this.tradingActive = false;
                        this.aiSignalStatus = '중지됨';
                        this.systemStatus = '중지됨';
                        this.leverage = 0;
                        this.totalInvestment = 0;
                        this.stopRunningTimer();
                    }
                },
                
                startRunningTimer() {
                    this.runningSeconds = 0;
                    this.runningTimer = setInterval(() => {
                        this.runningSeconds++;
                        this.updateRunningTime();
                    }, 1000);
                },
                
                stopRunningTimer() {
                    if (this.runningTimer) {
                        clearInterval(this.runningTimer);
                        this.runningTimer = null;
                    }
                },
                
                updateRunningTime() {
                    const hours = Math.floor(this.runningSeconds / 3600);
                    const minutes = Math.floor((this.runningSeconds % 3600) / 60);
                    const seconds = this.runningSeconds % 60;
                    
                    this.runningTime = 
                        `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                },
                
                updateStrategyDetails(strategy) {
                    const strategies = {
                        momentum: {
                            title: 'DeepSignal V2.0 - 모멘텀 전략',
                            description: '이 전략은 강한 모멘텀을 보이는 코인을 식별하여 진입하는 알고리즘입니다. 시장의 추세가 강할 때 진입하여 단기 이익을 실현하는 것을 목표로 합니다.',
                            indicators: '• RSI (Relative Strength Index) - 과매수/과매도 구간 판단\n• MACD (Moving Average Convergence Divergence) - 모멘텀 변화 감지\n• 이동평균선 (EMA 9, 21, 50) - 추세 판단',
                            riskManagement: '• Stop-loss: 2% 하락 시 자동 청산\n• Take-profit: 5% 상승 시 부분 청산 (50%), 8% 상승 시 전량 청산',
                            backtestResult: '99.2%'
                        },
                        meanReversion: {
                            title: 'DeepSignal V1.5 - 평균 회귀 전략',
                            description: '이 전략은 Bollinger Bands와 RSI를 활용하여 가격이 평균으로 회귀할 것을 예상하는 알고리즘입니다. 과매수/과매도 구간에서 반대 방향으로 진입합니다.',
                            indicators: '• Bollinger Bands - 변동성 및 평균 회귀 신호\n• RSI (Relative Strength Index) - 과매수/과매도 판단\n• Stochastic Oscillator - 모멘텀 확인',
                            riskManagement: '• Stop-loss: 3% 하락 시 자동 청산\n• Take-profit: 4% 상승 시 전량 청산',
                            backtestResult: '87.5%'
                        },
                        volatilityBreakout: {
                            title: 'DeepSignal V1.0 - 변동성 돌파 전략',
                            description: '이 전략은 전일 변동성을 기준으로 당일 가격이 돌파하는지 확인하여 진입하는 알고리즘입니다. 강한 변동성 돌파 시 추세를 따라 진입합니다.',
                            indicators: '• ATR (Average True Range) - 변동성 측정\n• 전일 고가/저가 - 돌파 기준점 설정\n• 거래량 - 돌파 신호 확인',
                            riskManagement: '• Stop-loss: 1.5% 하락 시 자동 청산\n• Take-profit: 3% 상승 시 전량 청산',
                            backtestResult: '92.8%'
                        }
                    };
                    
                    this.strategyDetails = strategies[strategy] || strategies.momentum;
                },
                
                formatNumber(num) {
                    if (typeof num === 'number') {
                        if (num === Math.floor(num)) {
                            return num.toLocaleString();
                        } else {
                            return num.toLocaleString(undefined, { 
                                minimumFractionDigits: 2, 
                                maximumFractionDigits: 2 
                            });
                        }
                    }
                    return '0';
                }
            },
            mounted() {
                this.updateStrategyDetails(this.selectedStrategy);
                this.loadApiConfig();
            },
            beforeDestroy() {
                this.stopTrading();
                this.stopDataUpdates();
            }
        });
    </script>
</body>
</html>