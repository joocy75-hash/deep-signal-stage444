<!DOCTYPE html>
<!-- CryptoJS ì¶”ê°€ -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeepSignal íŠ¸ë ˆì´ë”© ëŒ€ì‹œë³´ë“œ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    
    <!-- ì¸ì¦ ì²´í¬ -->
    <script>
        // ê°„ë‹¨í•œ ì¸ì¦ ì²´í¬
        if (!localStorage.getItem('isLoggedIn') && !sessionStorage.getItem('isLoggedIn')) {
            alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
            window.location.href = 'index.html';
        }
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Malgun Gothic', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f1b2f 0%, #1a2b44 100%);
            color: #eaecef;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(30, 35, 41, 0.8);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .logo {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, #00d4aa 0%, #0099ff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
        }
        
        .logo i {
            margin-right: 10px;
            font-size: 24px;
        }
        
        .user-menu {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f0b90b 0%, #f8d33a 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1e2329;
            font-weight: bold;
            font-size: 16px;
        }
        
        .connection-status {
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
        }
        
        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
            animation: pulse 2s infinite;
        }
        
        .status-connected {
            background-color: #03a66d;
        }
        
        .status-disconnected {
            background-color: #e74c3c;
        }
        
        .status-connecting {
            background-color: #f0b90b;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        /* ì •ë³´ íŒ¨ë„ */
        .info-panel {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .info-card {
            background: linear-gradient(135deg, #1e2329 0%, #2a2f36 100%);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .info-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #00d4aa, #0099ff);
        }
        
        .info-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
        }
        
        .card-title {
            font-size: 14px;
            color: #848e9c;
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .card-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 24px;
            font-weight: 700;
        }
        
        .coin-logo {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f0b90b 0%, #f8d33a 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #1e2329;
            font-size: 14px;
        }
        
        .profit-positive {
            color: #03a66d;
        }
        
        .profit-negative {
            color: #e74c3c;
        }
        
        /* ë©”ì¸ ì½˜í…ì¸  */
        .main-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .chart-container {
            background: rgba(30, 35, 41, 0.8);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .chart-title {
            font-size: 20px;
            font-weight: 600;
        }
        
        .chart-options {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .timeframe-options {
            display: flex;
            background: rgba(42, 47, 54, 0.8);
            border-radius: 10px;
            padding: 5px;
            gap: 5px;
        }
        
        .timeframe {
            padding: 8px 15px;
            border-radius: 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .timeframe.active {
            background: linear-gradient(135deg, #00d4aa 0%, #0099ff 100%);
            color: white;
        }
        
        .exchange-badge {
            background: linear-gradient(135deg, #f0b90b 0%, #f8d33a 100%);
            color: #1e2329;
            padding: 8px 15px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 700;
        }
        
        .chart-area {
            height: 400px;
            background: rgba(11, 14, 17, 0.8);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .chart-placeholder {
            color: #848e9c;
            font-size: 16px;
            text-align: center;
        }
        
        /* AI ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
        .ai-control-panel {
            background: rgba(30, 35, 41, 0.8);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .panel-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .strategy-selector {
            margin-bottom: 25px;
        }
        
        .strategy-dropdown {
            width: 100%;
            background: rgba(42, 47, 54, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            color: #eaecef;
            font-size: 14px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }
        
        .strategy-dropdown:focus {
            outline: none;
            border-color: #00d4aa;
            box-shadow: 0 0 0 2px rgba(0, 212, 170, 0.2);
        }
        
        .control-buttons {
            display: flex;
            gap: 12px;
        }
        
        .btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn-start {
            background: linear-gradient(135deg, #03a66d 0%, #02c076 100%);
            color: white;
        }
        
        .btn-stop {
            background: linear-gradient(135deg, #e74c3c 0%, #f1948a 100%);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .ai-signal {
            background: rgba(42, 47, 54, 0.8);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .signal-title {
            font-size: 14px;
            color: #848e9c;
            margin-bottom: 10px;
        }
        
        .signal-status {
            font-size: 24px;
            font-weight: 700;
            color: #f0b90b;
        }
        
        .system-status {
            background: rgba(42, 47, 54, 0.8);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .status-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
        
        .status-label {
            font-size: 14px;
            color: #848e9c;
        }
        
        .status-value {
            font-size: 16px;
            font-weight: 600;
        }
        
        /* í•˜ë‹¨ íŒ¨ë„ */
        .bottom-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }
        
        .positions-panel, .strategy-panel {
            background: rgba(30, 35, 41, 0.8);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .panel-title {
            font-size: 18px;
            font-weight: 600;
            margin: 0;
            padding: 0;
            border: none;
        }
        
        .no-positions {
            text-align: center;
            padding: 60px 20px;
            color: #848e9c;
        }
        
        .no-positions i {
            font-size: 48px;
            margin-bottom: 15px;
            color: #2a2f36;
        }
        
        .strategy-content {
            max-height: 300px;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        .strategy-content::-webkit-scrollbar {
            width: 6px;
        }
        
        .strategy-content::-webkit-scrollbar-track {
            background: rgba(42, 47, 54, 0.8);
            border-radius: 3px;
        }
        
        .strategy-content::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #00d4aa 0%, #0099ff 100%);
            border-radius: 3px;
        }
        
        .strategy-section {
            margin-bottom: 25px;
        }
        
        .strategy-section-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
            color: #eaecef;
        }
        
        .strategy-text {
            font-size: 14px;
            line-height: 1.6;
            color: #9aa2ab;
            white-space: pre-line;
        }
        
        .backtest-result {
            background: rgba(42, 47, 54, 0.8);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .backtest-value {
            font-size: 28px;
            font-weight: 700;
            color: #03a66d;
            margin-top: 5px;
        }
        
        /* ê±°ë˜ ë‚´ì—­ í…Œì´ë¸” */
        .trades-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .trades-table th {
            background: rgba(42, 47, 54, 0.8);
            padding: 12px 15px;
            text-align: left;
            font-weight: 600;
            color: #848e9c;
            font-size: 12px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .trades-table td {
            padding: 12px 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 13px;
        }
        
        .trade-buy {
            color: #03a66d;
            font-weight: 600;
        }
        
        .trade-sell {
            color: #e74c3c;
            font-weight: 600;
        }
        
        /* ë¡œë”© ìŠ¤í”¼ë„ˆ */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            backdrop-filter: blur(5px);
        }
        
        .modal {
            background: linear-gradient(135deg, #1e2329 0%, #2a2f36 100%);
            border-radius: 20px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: modalSlideIn 0.3s ease-out;
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .modal-title {
            font-size: 22px;
            font-weight: 700;
            background: linear-gradient(135deg, #00d4aa 0%, #0099ff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .close-modal {
            background: none;
            border: none;
            color: #848e9c;
            font-size: 28px;
            cursor: pointer;
            padding: 5px;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        
        .close-modal:hover {
            color: #eaecef;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            color: #eaecef;
            font-weight: 600;
        }
        
        .form-input {
            width: 100%;
            padding: 15px;
            background: rgba(42, 47, 54, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            color: #eaecef;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #00d4aa;
            box-shadow: 0 0 0 2px rgba(0, 212, 170, 0.2);
            background: rgba(42, 47, 54, 1);
        }
        
        .form-help {
            font-size: 12px;
            color: #848e9c;
            margin-top: 8px;
            line-height: 1.4;
        }
        
        .form-help a {
            color: #00d4aa;
            text-decoration: none;
        }
        
        .form-help a:hover {
            text-decoration: underline;
        }
        
        .modal-actions {
            display: flex;
            gap: 12px;
            margin-top: 25px;
            justify-content: flex-end;
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #eaecef;
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .test-account-info {
            background: rgba(42, 47, 54, 0.8);
            border-radius: 10px;
            padding: 20px;
            margin-top: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .test-account-info code {
            background: rgba(0, 0, 0, 0.3);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
            color: #00d4aa;
        }
        
        .connection-message {
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 14px;
            font-weight: 500;
            border-left: 4px solid;
        }
        
        .connection-message.info {
            background: rgba(240, 185, 11, 0.1);
            color: #f0b90b;
            border-left-color: #f0b90b;
        }
        
        .connection-message.success {
            background: rgba(3, 166, 109, 0.1);
            color: #03a66d;
            border-left-color: #03a66d;
        }
        
        .connection-message.error {
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
            border-left-color: #e74c3c;
        }
        
        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 1200px) {
            .info-panel {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .bottom-panel {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .dashboard-container {
                padding: 15px;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .info-panel {
                grid-template-columns: 1fr;
            }
            
            .info-card {
                padding: 20px;
            }
            
            .chart-area {
                height: 300px;
            }
            
            .control-buttons {
                flex-direction: column;
            }
        }
        
        .zero-data {
            color: #848e9c;
            font-style: italic;
        }
        
        .btn-icon {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #eaecef;
            font-size: 16px;
            cursor: pointer;
            padding: 10px;
            border-radius: 10px;
            transition: all 0.3s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn-icon:hover {
            background: rgba(0, 212, 170, 0.2);
            color: #00d4aa;
            transform: rotate(90deg);
        }
        
        .update-time {
            font-size: 12px;
            color: #848e9c;
        }
    </style>
</head>
<body>
    <div id="app" class="dashboard-container">
        <!-- í—¤ë” -->
        <div class="header">
            <div class="logo">
                <i class="fas fa-brain"></i>
                DeepSignal AI
            </div>
            
            <div class="user-menu">
                <div class="connection-status">
                    <span class="status-dot" :class="connectionStatusClass"></span>
                    {{ connectionStatusText }}
                </div>
                <button @click="showApiConfig" class="btn-icon">
                    <i class="fas fa-cog"></i>
                </button>
                <span>Brianne</span>
                <div class="user-avatar">B</div>
            </div>
        </div>
        
        <!-- ì •ë³´ íŒ¨ë„ -->
        <div class="info-panel">
            <div class="info-card">
                <div class="card-title">í˜„ì¬ ì§„ì…ì¤‘ì¸ ì½”ì¸</div>
                <div class="card-content">
                    <div class="coin-logo">B</div>
                    <div>{{ apiConnected ? 'BTC/USDT' : 'ì—°ê²° í•„ìš”' }}</div>
                </div>
            </div>
            
            <div class="info-card">
                <div class="card-title">Balance (USDT)</div>
                <div class="card-content">
                    ${{ apiConnected ? formatNumber(balance.usdt) : '0' }}
                </div>
            </div>
            
            <div class="info-card">
                <div class="card-title">Balance (KRW)</div>
                <div class="card-content">
                    â‚©{{ apiConnected ? formatNumber(balance.krw) : '0' }}
                </div>
            </div>
            
            <div class="info-card">
                <div class="card-title">24ì‹œê°„ ìˆ˜ìµë¥ </div>
                <div class="card-content" :class="apiConnected ? (profit24h >= 0 ? 'profit-positive' : 'profit-negative') : ''">
                    {{ apiConnected ? (profit24h >= 0 ? '+' : '') + profit24h.toFixed(2) + '%' : '0%' }}
                </div>
            </div>
        </div>
        
        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <div class="main-content">
            <!-- ì°¨íŠ¸ ì˜ì—­ -->
            <div class="chart-container">
                <div class="chart-header">
                    <div class="chart-title">BTC/USDT ì‹¤ì‹œê°„ ì°¨íŠ¸</div>
                    <div class="chart-options">
                        <div class="timeframe-options">
                            <div 
                                v-for="timeframe in timeframes" 
                                :key="timeframe"
                                class="timeframe" 
                                :class="{ active: selectedTimeframe === timeframe }"
                                @click="changeTimeframe(timeframe)"
                            >
                                {{ timeframe }}
                            </div>
                        </div>
                        <div class="exchange-badge">BINANCE</div>
                    </div>
                </div>
                
                <div class="chart-area">
                    <div class="chart-placeholder">
                        <div v-if="!apiConnected">
                            <i class="fas fa-plug" style="font-size: 48px; margin-bottom: 15px; color: #848e9c;"></i>
                            <div>API ì—°ê²° í›„ ì‹¤ì‹œê°„ ì°¨íŠ¸ê°€ í‘œì‹œë©ë‹ˆë‹¤</div>
                        </div>
                        <div v-else>
                            <div v-if="!chartDataLoaded" class="loading"></div>
                            <div v-else>
                                <i class="fas fa-chart-line" style="font-size: 48px; margin-bottom: 15px; color: #00d4aa;"></i>
                                <div>ì‹¤ì‹œê°„ ì°¨íŠ¸ ë°ì´í„° ìŠ¤íŠ¸ë¦¬ë° ì¤‘...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- AI ì»¨íŠ¸ë¡¤ íŒ¨ë„ -->
            <div class="ai-control-panel">
                <div class="panel-title">AI íŠ¸ë ˆì´ë”© ì»¨íŠ¸ë¡¤</div>
                
                <div class="strategy-selector">
                    <select class="strategy-dropdown" v-model="selectedStrategy" :disabled="!apiConnected">
                        <option value="momentum">DeepSignal V2.0 - ëª¨ë©˜í…€ ì „ëµ</option>
                        <option value="meanReversion">DeepSignal V1.5 - í‰ê·  íšŒê·€ ì „ëµ</option>
                        <option value="volatilityBreakout">DeepSignal V1.0 - ë³€ë™ì„± ëŒíŒŒ ì „ëµ</option>
                    </select>
                    
                    <div class="control-buttons">
                        <button 
                            class="btn btn-start" 
                            :disabled="tradingActive || connecting || !apiConnected" 
                            @click="startTrading"
                        >
                            <span v-if="connecting" class="loading"></span>
                            {{ connecting ? 'ì—°ê²° ì¤‘' : 'START TRADING' }}
                        </button>
                        <button 
                            class="btn btn-stop" 
                            :disabled="!tradingActive || !apiConnected" 
                            @click="stopTrading"
                        >
                            STOP TRADING
                        </button>
                    </div>
                </div>
                
                <div class="ai-signal">
                    <div class="signal-title">í˜„ì¬ AI ì‹ í˜¸</div>
                    <div class="signal-status">{{ aiSignalStatus }}</div>
                </div>
                
                <div class="system-status">
                    <div class="status-item">
                        <div class="status-label">ì‹œìŠ¤í…œ ìƒíƒœ</div>
                        <div class="status-value">{{ systemStatus }}</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">ë ˆë²„ë¦¬ì§€</div>
                        <div class="status-value">{{ leverage }}x</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">ì´ íˆ¬ìê¸ˆì•¡</div>
                        <div class="status-value">${{ formatNumber(totalInvestment) }}</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">ì‹¤í–‰ ì‹œê°„</div>
                        <div class="status-value">{{ runningTime }}</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- í•˜ë‹¨ íŒ¨ë„ -->
        <div class="bottom-panel">
            <!-- í¬ì§€ì…˜ í˜„í™© -->
            <div class="positions-panel">
                <div class="panel-header">
                    <div class="panel-title">í™œì„± í¬ì§€ì…˜</div>
                    <div class="panel-actions">
                        <span class="update-time">ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸</span>
                    </div>
                </div>
                
                <div v-if="!apiConnected" class="no-positions">
                    <i class="fas fa-unlink"></i>
                    <div>API ì—°ê²°ì´ í•„ìš”í•©ë‹ˆë‹¤</div>
                    <button @click="showApiConfig" class="btn btn-start" style="margin-top: 15px;">
                        API ì„¤ì •í•˜ê¸°
                    </button>
                </div>
                
                <div v-else-if="openPositions.length === 0" class="no-positions">
                    <i class="fas fa-chart-line"></i>
                    <div>í™œì„± í¬ì§€ì…˜ì´ ì—†ìŠµë‹ˆë‹¤</div>
                    <div class="strategy-text" style="margin-top: 10px; font-size: 12px;">
                        AI íŠ¸ë ˆì´ë”©ì„ ì‹œì‘í•˜ë©´ í¬ì§€ì…˜ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤
                    </div>
                </div>
                
                <div v-else>
                    <table class="trades-table">
                        <thead>
                            <tr>
                                <th>ì½”ì¸</th>
                                <th>í¬ì§€ì…˜</th>
                                <th>ìˆ˜ëŸ‰</th>
                                <th>ì§„ì…ê°€</th>
                                <th>í˜„ì¬ê°€</th>
                                <th>ì†ìµ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="position in openPositions" :key="position.id">
                                <td>{{ position.symbol }}</td>
                                <td :class="position.side === 'BUY' ? 'trade-buy' : 'trade-sell'">
                                    {{ position.side === 'BUY' ? 'LONG' : 'SHORT' }}
                                </td>
                                <td>{{ position.quantity }}</td>
                                <td>${{ position.entryPrice.toFixed(2) }}</td>
                                <td>${{ position.currentPrice.toFixed(2) }}</td>
                                <td :class="position.pnl >= 0 ? 'profit-positive' : 'profit-negative'">
                                    ${{ position.pnl.toFixed(2) }}
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- ì „ëµ ì„¤ëª… -->
            <div class="strategy-panel">
                <div class="panel-header">
                    <div class="panel-title">ì „ëµ ìƒì„¸ ì •ë³´</div>
                </div>
                
                <div class="strategy-content">
                    <div class="strategy-section">
                        <div class="strategy-section-title">{{ strategyDetails.title }}</div>
                        <div class="strategy-text">
                            {{ strategyDetails.description }}
                        </div>
                    </div>
                    
                    <div class="strategy-section">
                        <div class="strategy-section-title">í™œìš© ê¸°ìˆ  ì§€í‘œ</div>
                        <div class="strategy-text">
                            {{ strategyDetails.indicators }}
                        </div>
                    </div>
                    
                    <div class="strategy-section">
                        <div class="strategy-section-title">ë¦¬ìŠ¤í¬ ê´€ë¦¬ ì„¤ì •</div>
                        <div class="strategy-text">
                            {{ strategyDetails.riskManagement }}
                        </div>
                    </div>
                    
                    <div class="backtest-result">
                        <div class="strategy-text">ì—­ëŒ€ ìµœê³  ë°±í…ŒìŠ¤íŒ… ìˆ˜ìµë¥ </div>
                        <div class="backtest-value">+{{ strategyDetails.backtestResult }}</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- API ì„¤ì • ëª¨ë‹¬ -->
        <div class="modal-overlay" v-if="showApiConfigModal">
            <div class="modal">
                <div class="modal-header">
                    <div class="modal-title">ğŸ”§ Binance API ì„¤ì •</div>
                    <button class="close-modal" @click="showApiConfigModal = false">&times;</button>
                </div>
                
                <div class="connection-message" :class="connectionMessageType" v-if="connectionMessage">
                    {{ connectionMessage }}
                </div>
                
                <div class="form-group">
                    <label class="form-label">API Key</label>
                    <input type="text" class="form-input" v-model="apiConfig.apiKey" 
                           placeholder="Binance API Keyë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                    <div class="form-help">
                        <a href="https://testnet.binance.vision/" target="_blank" style="color: #00d4aa;">
                            ğŸ”— Binance í…ŒìŠ¤íŠ¸ë„·ì—ì„œ API í‚¤ ë°œê¸‰ë°›ê¸°
                        </a>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Secret Key</label>
                    <input type="password" class="form-input" v-model="apiConfig.secretKey" 
                           placeholder="Binance Secret Keyë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                    <div class="form-help">í…ŒìŠ¤íŠ¸ë„·ì—ì„œ ë°œê¸‰ë°›ì€ Secret Keyë¥¼ ì…ë ¥í•˜ì„¸ìš”</div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">ë°±ì—”ë“œ ì„œë²„ ì£¼ì†Œ</label>
                    <input type="text" class="form-input" v-model="apiConfig.backendUrl" 
                           placeholder="http://localhost:8000">
                    <div class="form-help">FastAPI ë°±ì—”ë“œ ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ ì£¼ì†Œ</div>
                </div>
                
                <div class="modal-actions">
                    <button class="btn btn-secondary" @click="showApiConfigModal = false">ì·¨ì†Œ</button>
                    <button class="btn btn-start" @click="testConnection" :disabled="connecting">
                        <span v-if="connecting" class="loading"></span>
                        {{ connecting ? 'ì—°ê²° í…ŒìŠ¤íŠ¸ ì¤‘...' : 'ì—°ê²° í…ŒìŠ¤íŠ¸' }}
                    </button>
                    <button class="btn btn-start" @click="saveApiConfig" :disabled="connecting">
                        ì €ì¥ ë° ì—°ê²°
                    </button>
                </div>
                
                <!-- í…ŒìŠ¤íŠ¸ ê³„ì • ì •ë³´ -->
                <div class="test-account-info">
                    <div class="strategy-section-title">ğŸ§ª í…ŒìŠ¤íŠ¸ìš© API í‚¤ (ê°œë°œìš©)</div>
                    <div class="strategy-text">
                        API Key: <code>test_api_key_12345</code><br>
                        Secret Key: <code>test_secret_key_67890</code><br>
                        <small style="color: #848e9c;">â€» ì‹¤ì œ ê±°ë˜ê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ” í…ŒìŠ¤íŠ¸ í‚¤ì…ë‹ˆë‹¤</small>
                    </div>
                </div>
            </div>
        </div>
    </div><!-- app ë -->

    <!-- ëª¨ë“ˆ ìŠ¤í¬ë¦½íŠ¸ -->
    <script src="js/modules/utils.js"></script>
    <script src="js/modules/api.js"></script>
    <script src="js/modules/trading.js"></script>
    <script src="js/modules/charts.js"></script>
    <script src="js/main.js"></script>

    <!-- Vue ì• í”Œë¦¬ì¼€ì´ì…˜ -->
    <script>
        new Vue({
            el: '#app',
            data: {
                // API ì—°ê²° ìƒíƒœ
                apiConnected: false,
                connectionStatus: 'disconnected',
                connecting: false,
                connectionMessage: '',
                connectionMessageType: 'info',
                
                // API ì„¤ì • ëª¨ë‹¬
                showApiConfigModal: false,
                apiConfig: {
                    apiKey: '',
                    secretKey: '',
                    backendUrl: 'http://localhost:8000'
                },
                
                // íŠ¸ë ˆì´ë”© ìƒíƒœ
                tradingActive: false,
                aiSignalStatus: 'ì‹ í˜¸ ëŒ€ê¸° ì¤‘',
                systemStatus: 'ì‹œìŠ¤í…œ ì¤€ë¹„ ì™„ë£Œ',
                
                // ë°ì´í„°
                balance: {
                    usdt: 10000,
                    krw: 13500000
                },
                profit24h: 2.34,
                
                // ì°¨íŠ¸
                timeframes: ['1m', '5m', '15m', '1h', '4h', '1d', '1w'],
                selectedTimeframe: '1h',
                chartDataLoaded: true,
                
                // ì „ëµ
                selectedStrategy: 'momentum',
                leverage: 3,
                totalInvestment: 2500,
                runningTime: '00:00:00',
                
                // í¬ì§€ì…˜
                openPositions: [],
                
                // ì „ëµ ì„¤ëª…
                strategyDetails: {
                    title: 'DeepSignal V2.0 - ëª¨ë©˜í…€ ì „ëµ',
                    description: 'ì´ ì „ëµì€ ê°•í•œ ëª¨ë©˜í…€ì„ ë³´ì´ëŠ” ì½”ì¸ì„ ì‹ë³„í•˜ì—¬ ì§„ì…í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì…ë‹ˆë‹¤. ì‹œì¥ì˜ ì¶”ì„¸ê°€ ê°•í•  ë•Œ ì§„ì…í•˜ì—¬ ë‹¨ê¸° ì´ìµì„ ì‹¤í˜„í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.',
                    indicators: 'â€¢ RSI (Relative Strength Index) - ê³¼ë§¤ìˆ˜/ê³¼ë§¤ë„ êµ¬ê°„ íŒë‹¨\nâ€¢ MACD (Moving Average Convergence Divergence) - ëª¨ë©˜í…€ ë³€í™” ê°ì§€\nâ€¢ ì´ë™í‰ê· ì„  (EMA 9, 21, 50) - ì¶”ì„¸ íŒë‹¨\nâ€¢ ë³¼ë¦°ì € ë°´ë“œ - ë³€ë™ì„± ë¶„ì„',
                    riskManagement: 'â€¢ Stop-loss: 2% í•˜ë½ ì‹œ ìë™ ì²­ì‚°\nâ€¢ Take-profit: 5% ìƒìŠ¹ ì‹œ ë¶€ë¶„ ì²­ì‚° (50%)\nâ€¢ 8% ìƒìŠ¹ ì‹œ ì „ëŸ‰ ì²­ì‚°\nâ€¢ ìµœëŒ€ ë“œë¡œë‹¤ìš´: 15%',
                    backtestResult: '99.2%'
                }
            },
            computed: {
                connectionStatusClass() {
                    return {
                        'status-dot': true,
                        'status-connected': this.connectionStatus === 'connected',
                        'status-disconnected': this.connectionStatus === 'disconnected',
                        'status-connecting': this.connectionStatus === 'connecting'
                    };
                },
                connectionStatusText() {
                    return {
                        'connected': 'ì‹¤ì‹œê°„ ì—°ê²°ë¨',
                        'connecting': 'ì—°ê²° ì¤‘...',
                        'disconnected': 'ì—°ê²° ëŠê¹€'
                    }[this.connectionStatus];
                }
            },
            methods: {
                showApiConfig() {
                    // ì €ì¥ëœ API ì„¤ì •ì´ ìˆìœ¼ë©´ ë¶ˆëŸ¬ì˜¤ê¸°
                    const savedConfig = localStorage.getItem('deepSignalApiConfig');
                    if (savedConfig) {
                        this.apiConfig = JSON.parse(savedConfig);
                    }
                    this.showApiConfigModal = true;
                    this.connectionMessage = '';
                },

                async testConnection() {
    this.connecting = true;
    this.connectionMessage = 'ğŸ”— ì—°ê²° í…ŒìŠ¤íŠ¸ ì¤‘...';
    this.connectionMessageType = 'info';

    try {
        // 1. ë¨¼ì € ëª¨ë“ˆì´ ë¡œë“œë˜ì—ˆëŠ”ì§€ í™•ì¸
        if (typeof BinanceAPI === 'undefined') {
            throw new Error('BinanceAPI ëª¨ë“ˆì´ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤');
        }

        console.log('ğŸ”§ BinanceAPI ëª¨ë“ˆ ìƒíƒœ:', BinanceAPI);
        console.log('ğŸ”§ setApiKeys í•¨ìˆ˜ ì¡´ì¬:', typeof BinanceAPI.prototype.setApiKeys);

        // 2. API í‚¤ ì„¤ì • (í•¨ìˆ˜ê°€ ì¡´ì¬í•˜ëŠ”ì§€ ë‹¤ì‹œ í™•ì¸)
        if (this.apiConfig.apiKey && this.apiConfig.secretKey) {
            if (typeof BinanceAPI.prototype.setApiKeys === 'function') {
                BinanceAPI.prototype.setApiKeys(this.apiConfig.apiKey, this.apiConfig.secretKey);
                console.log('âœ… API í‚¤ ì„¤ì • ì™„ë£Œ');
            } else if (binanceAPI && typeof binanceAPI.setApiKeys === 'function') {
                binanceAPI.setApiKeys(this.apiConfig.apiKey, this.apiConfig.secretKey);
                console.log('âœ… API í‚¤ ì„¤ì • ì™„ë£Œ (ì¸ìŠ¤í„´ìŠ¤)');
            } else {
                console.warn('âš ï¸ setApiKeys í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
            }
        }

        // 3. ê¸°ë³¸ ì—°ê²° í…ŒìŠ¤íŠ¸ (ê³µê°œ API)
        const testResult = await binanceAPI.testConnection();
        
        if (testResult.success) {
            this.connectionMessage = 'âœ… Binance API ì—°ê²° ì„±ê³µ!';
            this.connectionMessageType = 'success';
            
            // ì¶”ê°€ í…ŒìŠ¤íŠ¸: í˜„ì¬ê°€ ì¡°íšŒ
            const price = await binanceAPI.getCurrentPrice('BTCUSDT');
            if (price && !price.error) {
                this.connectionMessage += ` BTC ê°€ê²©: $${parseFloat(price.price).toFixed(2)}`;
            }
        } else {
            throw new Error(testResult.error);
        }
        
    } catch (error) {
        console.error('âŒ ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:', error);
        this.connectionMessage = `âŒ ì—°ê²° ì‹¤íŒ¨: ${error.message}`;
        this.connectionMessageType = 'error';
        
        // ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ì¸ ê²½ìš°
        if (error.message.includes('Failed to fetch')) {
            this.connectionMessage += '\nğŸŒ ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•˜ì„¸ìš”';
        }
    } finally {
        this.connecting = false;
    }
},

                async saveApiConfig() {
                    // API ì„¤ì • ì €ì¥
                    localStorage.setItem('deepSignalApiConfig', JSON.stringify(this.apiConfig));
                    
                    // ëª¨ë“ˆì— API í‚¤ ì„¤ì •
                    if (typeof BinanceAPI !== 'undefined' && this.apiConfig.apiKey) {
                        BinanceAPI.setApiKeys(this.apiConfig.apiKey, this.apiConfig.secretKey);
                    }

                    // ì—°ê²° ìƒíƒœ ì—…ë°ì´íŠ¸
                    this.apiConnected = true;
                    this.connectionStatus = 'connected';
                    this.systemStatus = 'API ì—°ê²°ë¨';
                    
                    // ëª¨ë‹¬ ë‹«ê¸°
                    this.showApiConfigModal = false;
                    
                    // ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹œì‘
                    this.startDataUpdates();
                    
                    console.log('âœ… API ì„¤ì • ì €ì¥ ì™„ë£Œ:', this.apiConfig);
                },

                startDataUpdates() {
                    // 3ì´ˆë§ˆë‹¤ ë°ì´í„° ì—…ë°ì´íŠ¸
                    setInterval(() => {
                        if (this.apiConnected) {
                            this.updateMarketData();
                        }
                    }, 3000);
                },

                updateMarketData() {
                    // ì‹œì¥ ë°ì´í„° ì—…ë°ì´íŠ¸ (í…ŒìŠ¤íŠ¸ ë°ì´í„°)
                    if (this.apiConnected) {
                        // ëœë¤ ê°€ê²© ë³€ë™ ì‹œë®¬ë ˆì´ì…˜
                        const change = (Math.random() - 0.5) * 100;
                        this.balance.usdt = 10000 + change;
                        this.balance.krw = Math.round(this.balance.usdt * 1350);
                        this.profit24h = parseFloat((Math.random() * 4 - 2).toFixed(2));
                        
                        // AI ì‹ í˜¸ ì—…ë°ì´íŠ¸
                        const signals = ['ë§¤ìˆ˜ ì‹ í˜¸ ê°•í•¨', 'ë§¤ë„ ì‹ í˜¸ ê°ì§€', 'ë³´ìœ  ê¶Œì¥', 'ë³€ë™ì„± ì£¼ì˜'];
                        this.aiSignalStatus = signals[Math.floor(Math.random() * signals.length)];
                    }
                },

                changeTimeframe(timeframe) {
                    this.selectedTimeframe = timeframe;
                },
                
                startTrading() {
                    this.tradingActive = true;
                    this.aiSignalStatus = 'ë§¤ìˆ˜ ì‹ í˜¸ ê°ì§€!';
                    this.systemStatus = 'íŠ¸ë ˆì´ë”© ì‹¤í–‰ ì¤‘';
                    
                    // ëª¨ë“ˆ ì‚¬ìš©
                    if (typeof TradingEngine !== 'undefined') {
                        TradingEngine.startTrading(this.selectedStrategy, {
                            symbol: "BTCUSDT",
                            quantity: 0.001
                        });
                    }
                    
                    // ì‹¤í–‰ ì‹œê°„ íƒ€ì´ë¨¸ ì‹œì‘
                    this.startRunningTimer();
                },
                
                stopTrading() {
                    this.tradingActive = false;
                    this.aiSignalStatus = 'ì‹ í˜¸ ëŒ€ê¸° ì¤‘';
                    this.systemStatus = 'ëŒ€ê¸° ì¤‘';
                    
                    // ëª¨ë“ˆ ì‚¬ìš©
                    if (typeof TradingEngine !== 'undefined') {
                        TradingEngine.stopTrading();
                    }
                    
                    // íƒ€ì´ë¨¸ ì •ì§€
                    this.stopRunningTimer();
                },
                
                startRunningTimer() {
                    let seconds = 0;
                    setInterval(() => {
                        seconds++;
                        const hours = Math.floor(seconds / 3600);
                        const minutes = Math.floor((seconds % 3600) / 60);
                        const secs = seconds % 60;
                        this.runningTime = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
                    }, 1000);
                },
                
                stopRunningTimer() {
                    this.runningTime = '00:00:00';
                },
                
                formatNumber(num) {
                    if (typeof Utils !== 'undefined') {
                        return Utils.formatNumber(num, 2);
                    }
                    
                    if (typeof num === 'number') {
                        return num.toLocaleString(undefined, { 
                            minimumFractionDigits: 2, 
                            maximumFractionDigits: 2 
                        });
                    }
                    return '0';
                }
            },
            mounted() {
                console.log('ëŒ€ì‹œë³´ë“œê°€ ì„±ê³µì ìœ¼ë¡œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
                
                // ì €ì¥ëœ API ì„¤ì •ì´ ìˆìœ¼ë©´ ìë™ ì—°ê²°
                const savedConfig = localStorage.getItem('deepSignalApiConfig');
                if (savedConfig) {
                    const config = JSON.parse(savedConfig);
                    this.apiConfig = config;
                    this.apiConnected = true;
                    this.connectionStatus = 'connected';
                    this.systemStatus = 'API ì—°ê²°ë¨';
                    this.startDataUpdates();
                }
                
                // ëª¨ë“ˆ í…ŒìŠ¤íŠ¸
                setTimeout(() => {
                    if (typeof Utils !== 'undefined') {
                        console.log('âœ… Utils ëª¨ë“ˆ ë¡œë“œë¨');
                    }
                    if (typeof BinanceAPI !== 'undefined') {
                        console.log('âœ… BinanceAPI ëª¨ë“ˆ ë¡œë“œë¨');
                    }
                    if (typeof TradingEngine !== 'undefined') {
                        console.log('âœ… TradingEngine ëª¨ë“ˆ ë¡œë“œë¨');
                    }
                }, 1000);
            }
        });
    </script>
</body>
</html>